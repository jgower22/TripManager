<%- include('../partials/header.ejs')%>
    <main>
        <div id="main_content">
            <div class="inline_container left">
                <h2>Who Has Access</h2>
                <div class="access">
                    <%if (trip.createdBy.email === email) {%>
                        <p><%=trip.createdBy.firstName%> <%=trip.createdBy.lastName%> <b>(you, owner)</b></p>
                        <h4><%=trip.createdBy.email%></h4>
                    <%} else {%>
                        <p><%=trip.createdBy.firstName%> <%=trip.createdBy.lastName%> <b>(owner)</b></p>
                        <h4><%=trip.createdBy.email%></h4>
                    <%}%>
                </div>
                <%for (let i = 0; i < access.length; i++) {
                    let curUser = access[i].user;
                    let curAccessType = access[i].type;
                    if (curUser.email === email) {%>
                        <div class="access">
                            <p><%=curUser.firstName%> <%=curUser.lastName%> <b>(you, <%=curAccessType%>)</b></p>
                            <h4><%=curUser.email%></h4>
                        </div>
                    <%} else {%>
                        <div class="access">
                            <form>
                                <p><%=curUser.firstName%> <%=curUser.lastName%> <b>(<%=curAccessType%>)</b></p>
                                <%if (accessType === 'owner') {%>
                                    <button class="button" type="submit" formmethod="POST" formaction="/trips/<%=trip._id%>/<%=curUser._id%>?_method=DELETE">Remove</button>
                                <%}%>
                            </form>
                            <h4><%=curUser.email%></h4>
                        </div>
                    <%}
                }%>
            </div>
            <%if (accessType === 'owner') {%>
                <div class="inline_container right" id="new_access_container">
                    <h2>Add New User</h2>
                    <form action="/trips/<%=trip._id%>/access?_method=PUT" method="POST">
                        <label class="required" for="name">Email:</label>
                        <input type="text" id="email" name="email" placeholder="Email Address" required>
                        <label class="required" for="accessType">Access Level:</label>
                        <select name="accessType" id="accessType">
                            <option value="viewer">viewer</option>
                            <option value="editor">editor</option>
                        </select>
                        <input type="submit" value="Add User" id="trip_submit">
                    </form>
                </div>
            <%}%>
        </div>
    </main>
<%- include('../partials/footer.ejs')%>